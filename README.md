# Iris: Gateway for Cardano

Iris is a REST API gateway for the Cardano blockchain and a lightweight alternative to Blockfrost. It is primarily intended for private deployments. Transactions submitted through Iris are kept in an internal mempool overlay so API queries include outputs that are still pending on chain.

The Debian/Ubuntu package generated by running `pnpm run build` also manages installation of `cardano-node` and `cardano-db-sync` using `git` and `nix`.

`cardano-db-sync` is configured without the heavy `tx_cbor` table, instead, block and transaction CBOR bytes are read directly from the `cardano-node` ledger on-disc storage.

Iris is installed under the name `cardano-iris`, and creates the `/usr/local/bin/cardano-iris` file and `/etc/cardano-iris` directory.

## How to install

It isn't recommended installing this locally. The installed artifacts aren't yet cleanly removed upon uninstalling the package, and `cardano-node` and `cardano-db-sync` use a lot of resources.

### From source

When building from source you will need the following dependencies:

* `git`
* `nodejs`
* `npm`
* `bash`
* `go` v1.24 or later

```sh
git clone https://github.com/HeliosLang/iris iris
cd iris
npm install
npm run build
```

Copy the `cardano-iris-0.1.0.deb` package to the server you want to install this on, and run:

```sh
sudo dpkg -i cardano-iris-0.1.0.deb
```

The installation will ask if you want to configure `cardano-node` for preprod or for mainnet.

## API

Endpoints that return CBOR bytes support multiple formats depending on the `Accept` header:

* `application/cbor`: raw CBOR bytes
* `application/json`: `{ "cborHex": "<cbor-hex>" }`
* default (`text/plain`): `<cbor-hex>`

The `application/cbor` format is the most efficient and should be preferred for production applications.

### GET `/api/address/{address}/utxos`
Returns all current UTXOs at the provided Bech32 address. Use the optional `asset` query parameter to filter for a specific asset or `lovelace`.

### POST `/api/address/{address}/utxos`
Selects UTXOs for spending from the given address. The request body must be JSON:

```json
{
  "lovelace": "<amount>",
  "asset": "<policyid><assetname>",
  "minQuantity": "<min>",
  "algorithm": "largest-first" | "smallest-first"
}
```

`asset`, `minQuantity`, and `algorithm` are optional. Selected UTXOs are locked for 10 seconds.

### GET `/api/block/{block-hash}`
Returns CBOR bytes of the block with the given hash.

### GET `/api/block/{block-hash}/tx/{index}`
Returns CBOR bytes of the transaction at `index` within the specified block.

### GET `/api/chain/tip`
Returns the current chain tip information.

### GET `/api/parameters`
Returns the current network parameters in Helios JSON format.

### GET `/api/policy/{policy}/assets`
Lists all assets under the specified policy ID.

### GET `/api/policy/{policy}/asset/{asset-name}/addresses`
Lists all addresses holding the given asset.

### GET `/api/mempool`
Lists the transaction hashes currently kept in Iris' mempool overlay.

### POST `/api/tx`
Submits a transaction. The request body can be raw CBOR (`application/cbor`) or a JSON envelope with a `cborHex` field.

### GET `/api/tx/{tx-hash}`
Returns CBOR bytes of the transaction with the given hash.

### GET `/api/tx/{tx-hash}/block`
Returns the block information containing the given transaction.

### GET `/api/tx/{tx-hash}/output/{index}`
Returns CBOR bytes of the specified UTXO.
